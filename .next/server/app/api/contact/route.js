(()=>{var e={};e.id=8746,e.ids=[8746],e.modules={56037:e=>{"use strict";e.exports=require("mongoose")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},33052:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>v,routeModule:()=>w,serverHooks:()=>x,workAsyncStorage:()=>y,workUnitAsyncStorage:()=>f});var s={};r.r(s),r.d(s,{DELETE:()=>g,GET:()=>p,PATCH:()=>m,POST:()=>d});var n=r(42706),a=r(28203),o=r(45994),i=r(39187),c=r(3322),u=r(43694),l=r(75510);async function d(e){try{let t=await e.json();if(await (0,u.A)(),(await (0,l.l)({email:t.email})).blocked)return i.NextResponse.json({error:"Unable to process your request",message:"Your email has been blocked from submitting inquiries"},{status:403});let r=await c.A.create(t);return i.NextResponse.json(r,{status:201})}catch(e){return console.error("Error creating contact:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}async function p(e){try{let{searchParams:t}=new URL(e.url),r=parseInt(t.get("page")||"1"),s=parseInt(t.get("limit")||"10"),n=(r-1)*s,a={};t.get("name")&&(a.name={$regex:t.get("name"),$options:"i"}),t.get("email")&&(a.email={$regex:t.get("email"),$options:"i"}),t.get("status")&&(a.status=t.get("status"));let o=t.get("sortBy")||"createdAt",l="asc"===t.get("order")?1:-1;await (0,u.A)();let d=await c.A.countDocuments(a),p=await c.A.find(a).sort({[o]:l}).skip(n).limit(s).lean();return i.NextResponse.json({contacts:p,pagination:{currentPage:r,totalPages:Math.ceil(d/s),totalItems:d,itemsPerPage:s}},{status:200})}catch(e){return console.error("Error fetching contacts:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}async function m(e){try{let t=await e.json();await (0,u.A)();let r=await c.A.findByIdAndUpdate(t.id,{$set:t},{new:!0});if(!r)return i.NextResponse.json({error:"Contact not found"},{status:404});return i.NextResponse.json(r,{status:200})}catch(e){return console.error("Error updating contact:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}async function g(e){try{let t=await e.json();if(await (0,u.A)(),!await c.A.findByIdAndDelete(t.id))return i.NextResponse.json({error:"Contact not found"},{status:404});return i.NextResponse.json({message:"Contact deleted successfully"},{status:200})}catch(e){return console.error("Error deleting contact:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}let w=new n.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/contact/route",pathname:"/api/contact",filename:"route",bundlePath:"app/api/contact/route"},resolvedPagePath:"C:\\Users\\Administrator\\Desktop\\freelance_work_showcase\\app\\api\\contact\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:y,workUnitAsyncStorage:f,serverHooks:x}=w;function v(){return(0,o.patchFetch)({workAsyncStorage:y,workUnitAsyncStorage:f})}},96487:()=>{},78335:()=>{},43694:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var s=r(56037),n=r.n(s);if(!process.env.MONGODB_URI)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let a=process.env.MONGODB_URI,o=async function(){try{let e=await n().connect(a);return console.log("MongoDB connected successfully"),e}catch(e){throw console.error("Error connecting to MongoDB:",e),e}}},75510:(e,t,r)=>{"use strict";r.d(t,{l:()=>a});var s=r(43694),n=r(83879);async function a({email:e}){try{await (0,s.A)();let t=await n.A.findOne({email:e.toLowerCase(),active:!0});if(t)return{blocked:!0,reason:t.reason};return{blocked:!1}}catch(e){return console.error("Error checking block status:",e),{blocked:!1}}}},83879:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var s=r(56037),n=r.n(s);let a=new(n()).Schema({email:{type:String,required:!0,unique:!0,trim:!0,lowercase:!0},reason:{type:String,required:!0},userId:{type:n().Schema.Types.ObjectId,ref:"User",required:!1},blockedAt:{type:Date,default:Date.now},active:{type:Boolean,default:!0}},{timestamps:!0}),o=n().models.Blocklist||n().model("Blocklist",a)},3322:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var s=r(56037),n=r.n(s);let a=new(n()).Schema({name:{type:String,required:!0,trim:!0},email:{type:String,required:!0},message:{type:String,required:!0},status:{type:String,enum:["unread","read","replied"],default:"unread"},replies:[{message:{type:String,required:!0},createdAt:{type:Date,default:Date.now}}]},{timestamps:!0}),o=n().models.Contact||n().model("Contact",a)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[1989,5452],()=>r(33052));module.exports=s})();