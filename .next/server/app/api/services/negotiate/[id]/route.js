(()=>{var e={};e.id=8907,e.ids=[8907],e.modules={56037:e=>{"use strict";e.exports=require("mongoose")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},68103:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>v,routeModule:()=>g,serverHooks:()=>y,workAsyncStorage:()=>m,workUnitAsyncStorage:()=>f});var n={};r.r(n),r.d(n,{DELETE:()=>l,GET:()=>c,PATCH:()=>p});var s=r(42706),i=r(28203),o=r(45994),a=r(39187),u=r(43694),d=r(40984);async function c(e,{params:t}){try{let e=(await t).id;await (0,u.A)();let r=await d.A.findById(e).populate("service");if(!r)return a.NextResponse.json({error:"Negotiation not found"},{status:404});return a.NextResponse.json(r)}catch(e){if(e instanceof Error)return a.NextResponse.json({error:"Failed to fetch negotiation",details:e.message},{status:500});return a.NextResponse.json({error:"Failed to fetch negotiation"},{status:500})}}async function p(e,{params:t}){try{let r=(await t).id,{status:n}=await e.json();if(!n||!["pending","accepted","rejected","completed"].includes(n))return a.NextResponse.json({error:"Invalid status"},{status:400});await (0,u.A)();let s=await d.A.findByIdAndUpdate(r,{status:n},{new:!0,runValidators:!0});if(!s)return a.NextResponse.json({error:"Negotiation not found"},{status:404});return a.NextResponse.json(s)}catch(e){if(e instanceof Error)return a.NextResponse.json({error:"Failed to update negotiation",details:e.message},{status:500});return a.NextResponse.json({error:"Failed to update negotiation"},{status:500})}}async function l(e,{params:t}){try{let e=(await t).id;if(await (0,u.A)(),!await d.A.findByIdAndDelete(e))return a.NextResponse.json({error:"Negotiation not found"},{status:404});return a.NextResponse.json({message:"Negotiation deleted successfully"})}catch(e){if(e instanceof Error)return a.NextResponse.json({error:"Failed to delete negotiation",details:e.message},{status:500});return a.NextResponse.json({error:"Failed to delete negotiation"},{status:500})}}let g=new s.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/services/negotiate/[id]/route",pathname:"/api/services/negotiate/[id]",filename:"route",bundlePath:"app/api/services/negotiate/[id]/route"},resolvedPagePath:"C:\\Users\\Administrator\\Desktop\\freelance_work_showcase\\app\\api\\services\\negotiate\\[id]\\route.ts",nextConfigOutput:"",userland:n}),{workAsyncStorage:m,workUnitAsyncStorage:f,serverHooks:y}=g;function v(){return(0,o.patchFetch)({workAsyncStorage:m,workUnitAsyncStorage:f})}},96487:()=>{},78335:()=>{},43694:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(56037),s=r.n(n);if(!process.env.MONGODB_URI)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let i=process.env.MONGODB_URI,o=async function(){try{let e=await s().connect(i);return console.log("MongoDB connected successfully"),e}catch(e){throw console.error("Error connecting to MongoDB:",e),e}}},40984:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(56037),s=r.n(n);let i=new n.Schema({message:{type:String,required:[!0,"Reply message is required"],trim:!0},offerAmount:{type:Number,min:[0,"Offer amount cannot be negative"]},isFromAdmin:{type:Boolean,required:!0,default:!1},createdAt:{type:Date,default:Date.now}}),o=new n.Schema({service:{type:n.Schema.Types.ObjectId,ref:"Service",required:[!0,"Service ID is required"]},name:{type:String,required:[!0,"Name is required"],trim:!0},email:{type:String,required:[!0,"Email is required"],trim:!0,lowercase:!0},phone:{type:String,trim:!0},budget:{type:Number,required:[!0,"Budget is required"],min:[0,"Budget cannot be negative"]},currency:{type:String,required:[!0,"Currency is required"],enum:["INR","USD","EUR"]},message:{type:String,required:[!0,"Message is required"],trim:!0,minlength:[10,"Message must be at least 10 characters long"]},status:{type:String,enum:["pending","negotiating","accepted","rejected","completed"],default:"pending"},replies:[i],finalAmount:{type:Number,min:[0,"Final amount cannot be negative"]}},{timestamps:!0}),a=s().models.Negotiation||s().model("Negotiation",o)}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[1989,5452],()=>r(68103));module.exports=n})();